/*! BARNES-BUILDER 2018-06-16 */
function recursively_ajax(a,b,c){for(var d=[],e=a;b>=e;e++){var f=$($(".ean-nos")[e]).val();""==!f&&(d.push(f),availabilityCode[f]=$($(".ean-nos")[e]).data("availability"))}$.ajax({type:"POST",url:webContextRoot+"/bopis/check-bopis-eligibility.jsp",datatype:"json",data:{eanArray:d.toString()}}).done(function(d){if(d){var e=JSON.parse(d);if(e&&e.message){for(var f=a;b>=f;f++)$($(".not-available-in-store")[f]).removeClass("hidden").addClass("display-flex").attr("aria-hidden","false");heightCalculation()}else e&&showAvailability(e,a,b,c)}}).always(function(){c&&"undefined"!=typeof performance.mark&&"undefined"!=typeof performance.measure&&(performance.mark("Search_bopis_functionality_loading_ends"),performance.measure("SearchBopisDur","Search_bopis_functionality_loading_starts","Search_bopis_functionality_loading_ends"))})}function showAvailability(a,b,c){for(var d=b;c>=d;d++)void 0!=a.items[d%itemsPerRequest]&&(a.items[d%itemsPerRequest].eligible&&a.items[d%itemsPerRequest].available?($($(".not-available-in-store")[d]).addClass("hidden").removeClass("display-flex").attr("aria-hidden","true"),$($(".available-in-store")[d]).removeClass("hidden").addClass("display-flex").attr("aria-hidden","false")):!a.items[d%itemsPerRequest].eligible&&a.items[d%itemsPerRequest].available&&!$.isEmptyObject(availabilityCode)&&availabilityCode[a.items[d%itemsPerRequest].ean]<3?($($(".not-available-in-store")[d]).addClass("hidden").removeClass("display-flex").attr("aria-hidden","true"),$($(".buy-online-instore")[d]).removeClass("hidden").addClass("display-flex").attr("aria-hidden","false")):!a.items[d%itemsPerRequest].eligible&&!a.items[d%itemsPerRequest].available&&!$.isEmptyObject(availabilityCode)&&availabilityCode[a.items[d%itemsPerRequest].ean]<3?($($(".not-available-in-store")[d]).addClass("hidden").removeClass("display-flex").attr("aria-hidden","true"),$($(".buy-online-only")[d]).removeClass("hidden").addClass("display-flex").attr("aria-hidden","false")):!a.items[d%itemsPerRequest].eligible&&a.items[d%itemsPerRequest].available&&!$.isEmptyObject(availabilityCode)&&availabilityCode[a.items[d%itemsPerRequest].ean]>2?($($(".not-available-in-store")[d]).addClass("hidden").removeClass("display-flex").attr("aria-hidden","true"),$($(".in-store-purchase-only")[d]).removeClass("hidden").addClass("display-flex").attr("aria-hidden","false")):$($(".not-available-in-store")[d]).removeClass("hidden").addClass("display-flex").attr("aria-hidden","false"));heightCalculation()}function changeCheckboxPlp(){$("#bopisPlpRibbon").on("change",function(){var a=$("#plpRibbonText").html();if($("#bopisPlpRibbon").is(":checked")){if("undefined"!=typeof s_setP){var b=getAnalyticsEventCount();s_setP("digitalData.event["+b+"].eventInfo.eventName","BOPIS Filter Selected"),s_setP("digitalData.event["+b+"].eventInfo.eventAction","bopisFilterSelected"),s_setP("digitalData.event["+b+"].eventInfo.timeStamp",""+new Date),s_setP("digitalData.event["+b+"].category.primaryCategory","Buy Online Pay In Store"),_satellite.track("onBopisFilterSelected")}$("#checkBoxValue").attr("value","true"),$("#plpRibbonText").html(a.replace("View","Viewing")),$(".no-bopis-response").removeClass("hidden").addClass("display-flex").attr("aria-hidden","false"),$(".not-available-in-store").removeClass("hidden").addClass("display-flex").attr("aria-hidden","false");for(var c=Math.ceil(Number(Number($("#totalItemsShown").val())-Number($("#startItemsShown").val())-Number($("#bopisUnavailableCount").val())+1)/itemsPerRequest),d=0;c>d;d++){var e=d==c-1?!0:!1;recursively_ajax(d*itemsPerRequest,d*itemsPerRequest+(itemsPerRequest-1),e)}$(".loading-info").html("Item Availability Badge loaded")}else $("#checkBoxValue").attr("value","false"),$("#plpRibbonText").html(a.replace("Viewing","View")),$(".available-in-store").addClass("hidden").removeClass("display-flex"),$(".not-available-in-store").addClass("hidden").removeClass("display-flex"),$(".no-bopis-response").addClass("hidden").removeClass("display-flex"),$(".in-store-purchase-only").addClass("hidden").removeClass("display-flex"),$(".loading-info").html("Item Availability Badge removed"),heightCalculation();$("#bopisPlpRibbonForm").submit()});var a=$("#searchKey").val();""!=a&&null!=a&&$("#bopisPlpRibbon").click()}function showBadgesAfterAjaxPlp(){$(".no-bopis-response").removeClass("hidden").addClass("display-flex").attr("aria-hidden","false"),$(".not-available-in-store").removeClass("hidden").addClass("display-flex").attr("aria-hidden","false");for(var a=Math.ceil(Number(Number($("#totalItemsShown").val())-Number($("#startItemsShown").val())-Number($("#bopisUnavailableCount").val())+1)/itemsPerRequest),b=0;a>b;b++){var c=b==a-1?!0:!1;recursively_ajax(b*itemsPerRequest,b*itemsPerRequest+(itemsPerRequest-1),c)}$(".loading-info").html("Store Availability loaded")}var itemsPerRequest=Number($("#itemsPerRequest").val()),availabilityCode=new Object;