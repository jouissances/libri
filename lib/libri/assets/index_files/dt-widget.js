var byod_token=$('#dt-widget-container').data('dttoken');var byod_link=$('#dt-widget-container').data('dt-link');var host="https://api-bn.dropthought.com/feedback-widget";var byod_host="https://byod-bn.dropthought.com";var laodingBYOD="";if(byod_token!=""){laodingBYOD=byod_host+"/#/login/"+byod_token}
else if(byod_link!=""){laodingBYOD=byod_link}
var fbimg=host+'/dt-images/feedback.png';var loadingimg=host+'/dt-images/loading-black-small.gif';var timeoutSeconds=30000;var timeoutButton=100;var iframeLoadError;var isRetyrShow=!1;var isPageLoaded=!1;load_dt_feedback();hideFbButton();setTimeout(showFbButton,timeoutButton);function load_dt_feedback(){var btnDiv=document.createElement('div');btnDiv.id='dt-dialogBtn';btnDiv.className='open';var imgEle=document.createElement('img');imgEle.src=fbimg;imgEle.alt='Feedback button';imgEle.className='dt-fb-button';btnDiv.appendChild(imgEle);var iframe=document.createElement("iframe");iframe.className="iframe-content";iframe.id="dt-Iframe";iframe.scrolling="no";var p=document.createElement("p");p.id="dt-wait";var load_msg=document.createTextNode("Loading!");p.appendChild(load_msg);var load_img=document.createElement('img');load_img.src=loadingimg;load_img.alt='spinner-image';load_img.id='loading_image';var dt_loading=document.createElement('div');dt_loading.id='dt-loading';dt_loading.appendChild(p);dt_loading.appendChild(load_img);var dt_showerroe=document.createElement('div');dt_showerroe.id='dt-showerror';var p2=document.createElement("p");p2.id="dt-load-error-description";var err_msg=document.createTextNode("There was a problem in loading the widget. Please try again!");p2.appendChild(err_msg);var dt_retry=document.createElement("button");dt_retry.id="dt-retry";var retry_text=document.createTextNode("Retry");dt_retry.appendChild(retry_text);dt_showerroe.appendChild(p2);dt_showerroe.appendChild(dt_retry);var span_close=document.createElement('span');span_close.className="button";span_close.onclick=function(){closeFrame()};var span_text=document.createTextNode("X");span_close.appendChild(span_text);var lightboxDiv=document.createElement('div');lightboxDiv.id='lightbox';var lightbox_are=document.createElement('div');lightbox_are.id='lightbox_are';lightbox_are.className='modal__inner';lightbox_are.appendChild(dt_loading);lightbox_are.appendChild(dt_showerroe);lightbox_are.appendChild(iframe);lightbox_are.appendChild(span_close);lightboxDiv.appendChild(lightbox_are);document.getElementById('dt-widget-container').appendChild(btnDiv);document.getElementById('dt-widget-container').appendChild(lightboxDiv)}
$('.open').click(function(){loadFeedbackForm()});$('#dt-retry').click(function(){isPageLoaded=!1;isRetyrShow=!1;loadFeedbackForm()});$('.close').click(function(){closeFrame()});var glower=$('.modal__inner');glower.toggleClass('active');$(document).keyup(function(e){if(e.keyCode==27){closeFrame()}});var eventMethod=window.addEventListener?"addEventListener":"attachEvent";var eventer=window[eventMethod];var messageEvent=eventMethod==="attachEvent"?"onmessage":"message";eventer(messageEvent,function(e){if(e.data==="dt-close"||e.message==="dt-close"){closeFrame();hideFbButton();return}
if(e.data==="dt-pageloaded"||e.message==="dt-pageloaded"){clearTimeout(iframeLoadError);isPageLoaded=!0;if(!isRetyrShow){showDTscreen()}
return}
console.log(e)});function loadFeedbackForm(){$('#dt-Iframe').attr('src',laodingBYOD);$('#lightbox').fadeTo(1000,1);iframeLoadError=setTimeout(error,timeoutSeconds);showLoading()}
function error(){showErrorscreen()}
function closeFrame(){$("#lightbox").fadeOut()}
function hideFbButton(){document.getElementById('dt-dialogBtn').style.display="none"}
function showFbButton(){document.getElementById('dt-dialogBtn').style.display="block"}
function showLoading(){document.getElementById('dt-Iframe').style.display="none";document.getElementById('dt-loading').style.display="block";document.getElementById('dt-showerror').style.display="none"}
function showDTscreen(){document.getElementById('dt-Iframe').style.display="block";document.getElementById('dt-loading').style.display="none";document.getElementById('dt-showerror').style.display="none"}
function showErrorscreen(){document.getElementById('dt-Iframe').style.display="none";document.getElementById('dt-loading').style.display="none";document.getElementById('dt-showerror').style.display="block";isRetyrShow=!0}
function error(){showErrorscreen()}